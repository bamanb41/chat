var app=function(){"use strict";function t(){}const n=t=>t;function e(t){return t()}function o(){return Object.create(null)}function i(t){t.forEach(e)}function r(t){return"function"==typeof t}function a(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function s(n,e,o){n.$$.on_destroy.push(function(n,...e){if(null==n)return t;const o=n.subscribe(...e);return o.unsubscribe?()=>o.unsubscribe():o}(e,o))}function u(t,n,e=n){return t.set(e),n}const c="undefined"!=typeof window;let f=c?()=>window.performance.now():()=>Date.now(),l=c?t=>requestAnimationFrame(t):t;const p=new Set;function h(t){p.forEach(n=>{n.c(t)||(p.delete(n),n.f())}),0!==p.size&&l(h)}function d(t){let n;return 0===p.size&&l(h),{promise:new Promise(e=>{p.add(n={c:t,f:e})}),abort(){p.delete(n)}}}function g(t,n){t.appendChild(n)}function m(t,n,e){t.insertBefore(n,e||null)}function v(t){t.parentNode.removeChild(t)}function b(t){return document.createElement(t)}function y(t){return document.createTextNode(t)}function k(){return y(" ")}function _(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function $(t){return function(n){return n.preventDefault(),t.call(this,n)}}function w(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function x(t,n){n=""+n,t.data!==n&&(t.data=n)}function j(t,n){(null!=n||t.value)&&(t.value=n)}function S(t,n,e){t.classList[e?"add":"remove"](n)}const O=new Set;let D,G=0;function N(t,n,e,o,i,r,a,s=0){const u=16.666/o;let c="{\n";for(let t=0;t<=1;t+=u){const o=n+(e-n)*r(t);c+=100*t+`%{${a(o,1-o)}}\n`}const f=c+`100% {${a(e,1-e)}}\n}`,l=`__svelte_${function(t){let n=5381,e=t.length;for(;e--;)n=(n<<5)-n^t.charCodeAt(e);return n>>>0}(f)}_${s}`,p=t.ownerDocument;O.add(p);const h=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(b("style")).sheet),d=p.__svelte_rules||(p.__svelte_rules={});d[l]||(d[l]=!0,h.insertRule(`@keyframes ${l} ${f}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?g+", ":""}${l} ${o}ms linear ${i}ms 1 both`,G+=1,l}function T(t,n){const e=(t.style.animation||"").split(", "),o=e.filter(n?t=>t.indexOf(n)<0:t=>-1===t.indexOf("__svelte")),i=e.length-o.length;i&&(t.style.animation=o.join(", "),G-=i,G||l(()=>{G||(O.forEach(t=>{const n=t.__svelte_stylesheet;let e=n.cssRules.length;for(;e--;)n.deleteRule(e);t.__svelte_rules={}}),O.clear())}))}function A(t){D=t}function I(){if(!D)throw new Error("Function called outside component initialization");return D}const J=[],E=[],M=[],C=[],P=Promise.resolve();let F=!1;function q(t){M.push(t)}let H=!1;const W=new Set;function L(){if(!H){H=!0;do{for(let t=0;t<J.length;t+=1){const n=J[t];A(n),R(n.$$)}for(J.length=0;E.length;)E.pop()();for(let t=0;t<M.length;t+=1){const n=M[t];W.has(n)||(W.add(n),n())}M.length=0}while(J.length);for(;C.length;)C.pop()();F=!1,H=!1,W.clear()}}function R(t){if(null!==t.fragment){t.update(),i(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(q)}}let B;function U(){return B||(B=Promise.resolve(),B.then(()=>{B=null})),B}function z(t,n,e){t.dispatchEvent(function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(`${n?"intro":"outro"}${e}`))}const K=new Set;let Q;function V(){Q={r:0,c:[],p:Q}}function X(){Q.r||i(Q.c),Q=Q.p}function Z(t,n){t&&t.i&&(K.delete(t),t.i(n))}function Y(t,n,e,o){if(t&&t.o){if(K.has(t))return;K.add(t),Q.c.push(()=>{K.delete(t),o&&(e&&t.d(1),o())}),t.o(n)}}const tt={duration:0};function nt(e,o,i){let a,s,u=o(e,i),c=!1,l=0;function p(){a&&T(e,a)}function h(){const{delay:o=0,duration:i=300,easing:r=n,tick:h=t,css:g}=u||tt;g&&(a=N(e,0,1,i,o,r,g,l++)),h(0,1);const m=f()+o,v=m+i;s&&s.abort(),c=!0,q(()=>z(e,!0,"start")),s=d(t=>{if(c){if(t>=v)return h(1,0),z(e,!0,"end"),p(),c=!1;if(t>=m){const n=r((t-m)/i);h(n,1-n)}}return c})}let g=!1;return{start(){g||(T(e),r(u)?(u=u(),U().then(h)):h())},invalidate(){g=!1},end(){c&&(p(),c=!1)}}}function et(e,o,a){let s,u=o(e,a),c=!0;const l=Q;function p(){const{delay:o=0,duration:r=300,easing:a=n,tick:p=t,css:h}=u||tt;h&&(s=N(e,1,0,r,o,a,h));const g=f()+o,m=g+r;q(()=>z(e,!1,"start")),d(t=>{if(c){if(t>=m)return p(0,1),z(e,!1,"end"),--l.r||i(l.c),!1;if(t>=g){const n=a((t-g)/r);p(1-n,n)}}return c})}return l.r+=1,r(u)?U().then(()=>{u=u(),p()}):p(),{end(t){t&&u.tick&&u.tick(1,0),c&&(s&&T(e,s),c=!1)}}}function ot(t,n){Y(t,1,1,()=>{n.delete(t.key)})}function it(t,n){-1===t.$$.dirty[0]&&(J.push(t),F||(F=!0,P.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function rt(n,a,s,u,c,f,l=[-1]){const p=D;A(n);const h=a.props||{},d=n.$$={fragment:null,ctx:null,props:f,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:[]),callbacks:o(),dirty:l};let g=!1;if(d.ctx=s?s(n,h,(t,e,...o)=>{const i=o.length?o[0]:e;return d.ctx&&c(d.ctx[t],d.ctx[t]=i)&&(d.bound[t]&&d.bound[t](i),g&&it(n,t)),e}):[],d.update(),g=!0,i(d.before_update),d.fragment=!!u&&u(d.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);d.fragment&&d.fragment.l(t),t.forEach(v)}else d.fragment&&d.fragment.c();a.intro&&Z(n.$$.fragment),function(t,n,o){const{fragment:a,on_mount:s,on_destroy:u,after_update:c}=t.$$;a&&a.m(n,o),q(()=>{const n=s.map(e).filter(r);u?u.push(...n):i(n),t.$$.on_mount=[]}),c.forEach(q)}(n,a.target,a.anchor),L()}A(p)}const at=[];function st(n,e=t){let o;const i=[];function r(t){if(a(n,t)&&(n=t,o)){const t=!at.length;for(let t=0;t<i.length;t+=1){const e=i[t];e[1](),at.push(e,n)}if(t){for(let t=0;t<at.length;t+=2)at[t][0](at[t+1]);at.length=0}}}return{set:r,update:function(t){r(t(n))},subscribe:function(a,s=t){const u=[a,s];return i.push(u),1===i.length&&(o=e(r)||t),a(n),()=>{const t=i.indexOf(u);-1!==t&&i.splice(t,1),0===i.length&&(o(),o=null)}}}}var ut="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var ct=function(t,n){return t(n={exports:{}},n.exports),n.exports}((function(t){!function(){var n;"undefined"!=typeof window&&(n=window),void 0!==ut&&(n=ut);var e=(n=n||{}).console||{log:function(){}};function o(t,n){return n?function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}():t.slice?o[e(t)]:function(n,i){t(n={exports:{}}),o[e(i)]=n.exports};function e(t){return t.split("/").slice(-1).toString().replace(".js","")}}var i=t;o((function(t){var n={fn:{is:function(t){return!!t&&"function"==typeof t}}};n.bi={is:function(t){return t instanceof Boolean||"boolean"==typeof t}},n.num={is:function(t){return!o(t)&&(t-parseFloat(t)+1>=0||1/0===t||-1/0===t)}},n.text={is:function(t){return"string"==typeof t}},n.text.ify=function(t){return n.text.is(t)?t:"undefined"!=typeof JSON?JSON.stringify(t):t&&t.toString?t.toString():t},n.text.random=function(t,n){var e="";for(t=t||24,n=n||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t>0;)e+=n.charAt(Math.floor(Math.random()*n.length)),t--;return e},n.text.match=function(t,n){var e,o;return"string"==typeof t&&("string"==typeof n&&(n={"=":n}),t===(e=(n=n||{})["="]||n["*"]||n[">"]||n["<"])||o===n["="]&&(e=n["*"]||n[">"]||n["<"],t.slice(0,(e||"").length)===e||o===n["*"]&&(o!==n[">"]&&o!==n["<"]?t>=n[">"]&&t<=n["<"]:o!==n[">"]&&t>=n[">"]||o!==n["<"]&&t<=n["<"])))},n.list={is:function(t){return t instanceof Array}},n.list.slit=Array.prototype.slice,n.list.sort=function(t){return function(n,e){return n&&e?(n=n[t])<(e=e[t])?-1:n>e?1:0:0}},n.list.map=function(t,n,e){return s(t,n,e)},n.list.index=1,n.obj={is:function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])}},n.obj.put=function(t,n,e){return(t||{})[n]=e,t},n.obj.has=function(t,n){return t&&Object.prototype.hasOwnProperty.call(t,n)},n.obj.del=function(t,n){if(t)return t[n]=null,delete t[n],t},n.obj.as=function(t,n,e,o){return t[n]=t[n]||(o===e?{}:e)},n.obj.ify=function(t){if(r(t))return t;try{t=JSON.parse(t)}catch(n){t={}}return t},function(){function t(t,n){a(this,n)&&void 0!==this[n]||(this[n]=t)}n.obj.to=function(n,e){return s(n,t,e=e||{}),e}}(),n.obj.copy=function(t){return t?JSON.parse(JSON.stringify(t)):t},function(){function t(t,n){var e=this.n;if(!e||!(n===e||r(e)&&a(e,n)))return!!n||void 0}n.obj.empty=function(n,e){return!n||!s(n,t,{n:e})}}(),function(){function t(n,e){if(2===arguments.length)return t.r=t.r||{},void(t.r[n]=e);t.r=t.r||[],t.r.push(n)}var i,s=Object.keys;Object.keys=Object.keys||function(t){return i(t,(function(t,n,e){e(n)}))},n.obj.map=i=function(i,u,c){var f,l,p,h,d,g=0,m=e(u);if(t.r=null,s&&r(i)&&(h=s(i),d=!0),o(i)||h)for(l=(h||i).length;g<l;g++){var v=g+n.list.index;if(m){if((p=d?u.call(c||this,i[h[g]],h[g],t):u.call(c||this,i[g],v,t))!==f)return p}else if(u===i[d?h[g]:g])return h?h[g]:v}else for(g in i)if(m){if(a(i,g)&&(p=c?u.call(c,i[g],g,t):u(i[g],g,t))!==f)return p}else if(u===i[g])return g;return m?t.r:n.list.index?0:-1}}(),n.time={},n.time.is=function(t){return t?t instanceof Date:+(new Date).getTime()};var e=n.fn.is,o=n.list.is,i=n.obj,r=i.is,a=i.has,s=i.map;t.exports=n}))(o,"./type"),o((function(t){t.exports=function t(n,e,o){if(!n)return{to:t};n=(this.tag||(this.tag={}))[n]||(this.tag[n]={tag:n,to:t._={next:function(t){var n;(n=this.to)&&n.next(t)}}});if(e instanceof Function){var i={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:e,the:n,on:this,as:o};return(i.back=n.last||n).to=i,n.last=i}return(n=n.to)&&void 0!==e&&n.next(e),n}}))(o,"./onto"),o((function(t){if("undefined"==typeof JSON)throw new Error("JSON is not included in this browser. Please load it first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");var n=JSON.stringify;t.exports=function(t,e,o,i,r){if(t<e)return{defer:!0};if(e<o)return{historical:!0};if(o<e)return{converge:!0,incoming:!0};if(e===o){if((i=n(i)||"")===(r=n(r)||""))return{state:!0};if(i<r)return{converge:!0,current:!0};if(r<i)return{converge:!0,incoming:!0}}return{err:"Invalid CRDT Data: "+i+" to "+r+" at "+e+" to "+o+"!"}}}))(o,"./HAM"),o((function(t){var n=o("./type"),e={is:function(t){return void 0!==t&&(null===t||t!==1/0&&(!!(s(t)||r(t)||a(t))||(e.link.is(t)||!1)))}};e.link=e.rel={_:"#"},function(){function t(t,n){var e=this;return e.id?e.id=!1:n==i&&s(t)?void(e.id=t):e.id=!1}e.link.is=function(n){if(n&&n[i]&&!n._&&c(n)){var e={};if(l(n,t,e),e.id)return e.id}return!1}}(),e.link.ify=function(t){return f({},i,t)},n.obj.has._=".";var i=e.link._,r=n.bi.is,a=n.num.is,s=n.text.is,u=n.obj,c=u.is,f=u.put,l=u.map;t.exports=e}))(o,"./val"),o((function(t){var n=o("./type"),e=o("./val"),i={_:"_",soul:function(t,n){return t&&t._&&t._[n||f]}};i.soul.ify=function(t,n){return n="string"==typeof n?{soul:n}:n||{},(t=t||{})._=t._||{},t._[f]=n.soul||t._[f]||c(),t},i.soul._=e.link._,function(){function t(t,n){if(n!==i._)return!e.is(t)||void(this.cb&&this.cb.call(this.as,t,n,this.n,this.s))}i.is=function(n,e,o){var r;return!!a(n)&&(!!(r=i.soul(n))&&!u(n,t,{as:o,cb:e,s:r,n:n}))}}(),function(){function t(t,n){var o,i=this.o;i.map?void 0===(o=i.map.call(this.as,t,""+n,i.node))?s(i.node,n):i.node&&(i.node[n]=o):e.is(t)&&(i.node[n]=t)}i.ify=function(n,e,o){return e?"string"==typeof e?e={soul:e}:e instanceof Function&&(e={map:e}):e={},e.map&&(e.node=e.map.call(o,n,void 0,e.node||{})),(e.node=i.soul.ify(e.node||{},e))&&u(n,t,{o:e,as:o}),e.node}}();var r=n.obj,a=r.is,s=r.del,u=r.map,c=n.text.random,f=i.soul._;t.exports=i}))(o,"./node"),o((function(t){var n=o("./type"),e=o("./node");function i(){var t;return t=r(),a<t?(s=0,a=t+i.drift):a=t+(s+=1)/u+i.drift}var r=n.time.is,a=-1/0,s=0,u=1e3,c="undefined"!=typeof performance&&(performance.timing&&performance);c&&c.timing&&c.timing.navigationStart||(c=!1);i._=">",i.drift=0,i.is=function(t,n,e){var o=n&&t&&t[y]&&t[y][i._]||e;if(o)return v(o=o[n])?o:-1/0},i.lex=function(){return i().toString(36).replace(".","")},i.ify=function(t,n,o,r,a){if(!t||!t[y]){if(!a)return;t=e.soul.ify(t,a)}var s=p(t[y],i._);return f!==n&&n!==y&&(v(o)&&(s[n]=o),f!==r&&(t[n]=r)),t},i.to=function(t,n,o){var r=(t||{})[n];return d(r)&&(r=m(r)),i.ify(o,n,i.is(t,n),r,e.soul(t))},function(){function t(t,n){y!==n&&i.ify(this.o,n,this.s)}i.map=function(n,e,o){var r,a=d(a=n||e)?a:null;return n=b(n=n||e)?n:null,a&&!n?(e=v(e)?e:i(),a[y]=a[y]||{},g(a,t,{o:a,s:e}),a):(o=o||d(e)?e:r,e=v(e)?e:i(),function(i,a,s,u){if(!n)return t.call({o:s,s:e},i,a),i;n.call(o||this||{},i,a,s,u),h(s,a)&&r===s[a]||t.call({o:s,s:e},i,a)})}}();var f,l=n.obj,p=l.as,h=l.has,d=l.is,g=l.map,m=l.copy,v=n.num.is,b=n.fn.is,y=e._;t.exports=i}))(o,"./state"),o((function(t){var n=o("./type"),e=o("./val"),i=o("./node"),r={};!function(){function t(t,e){if(!t||e!==i.soul(t)||!i.is(t,this.fn,this.as))return!0;this.cb&&(n.n=t,n.as=this.as,this.cb.call(n.as,t,e,n))}function n(t){t&&i.is(n.n,t,n.as)}r.is=function(n,e,o,i){return!(!n||!s(n)||f(n))&&!p(n,t,{cb:e,fn:o,as:i})}}(),function(){function t(t,n){var r;return(r=function(t,n){var e,o=t.seen,i=o.length;for(;i--;)if(e=o[i],n.obj===e.obj)return e;o.push(n)}(t,n))?r:(n.env=t,n.soul=a,i.ify(n.obj,o,n)&&(n.link=n.link||e.link.ify(i.soul(n.node)),n.obj!==t.shell&&(t.graph[e.link.is(n.link)]=n.node)),n)}function o(n,o,r){var a,s,l=this,p=l.env;if(i._===o&&c(n,e.link._))return r._;if(a=f(n,o,r,l,p)){if(o||(l.node=l.node||r||{},c(n,i._)&&i.soul(n)&&(l.node._=h(n._)),l.node=i.soul.ify(l.node,e.link.is(l.link)),l.link=l.link||e.link.ify(i.soul(l.node))),(s=p.map)&&(s.call(p.as||{},n,o,r,l),c(r,o))){if(void 0===(n=r[o]))return void u(r,o);if(!(a=f(n,o,r,l,p)))return}if(!o)return l.node;if(!0===a)return n;if((s=t(p,{obj:n,path:l.path.concat(o)})).node)return s.link}}function a(t){var n=this,o=e.link.is(n.link),r=n.env.graph;n.link=n.link||e.link.ify(t),n.link[e.link._]=t,n.node&&n.node[i._]&&(n.node[i._][e.link._]=t),c(r,o)&&(r[t]=r[o],u(r,o))}function f(t,o,i,r,a){var u;return!!e.is(t)||(s(t)?1:(u=a.invalid)?f(t=u.call(a.as||{},t,o,i),o,i,r,a):(a.err="Invalid value at '"+r.path.concat(o).join(".")+"'!",void(n.list.is(t)&&(a.err+=" Use `.set(item)` instead of an Array."))))}r.ify=function(n,o,i){var r={path:[],obj:n};return o?"string"==typeof o?o={soul:o}:o instanceof Function&&(o.map=o):o={},o.soul&&(r.link=e.link.ify(o.soul)),o.shell=(i||{}).shell,o.graph=o.graph||{},o.seen=o.seen||[],o.as=o.as||i,t(o,r),o.root=r.node,o.graph}}(),r.node=function(t){var n=i.soul(t);if(n)return l({},n,t)},function(){function t(t,n){var o,a;if(i._!==n)(o=e.link.is(t))?(a=this.opt.seen[o])?this.obj[n]=a:this.obj[n]=this.opt.seen[o]=r.to(this.graph,o,this.opt):this.obj[n]=t;else{if(f(t,e.link._))return;this.obj[n]=h(t)}}r.to=function(n,e,o){if(n){var i={};return o=o||{seen:{}},p(n[e],t,{obj:i,graph:n,opt:o}),i}}}();n.fn.is;var a=n.obj,s=a.is,u=a.del,c=a.has,f=a.empty,l=a.put,p=a.map,h=a.copy;t.exports=r}))(o,"./graph"),o((function(t){o("./onto"),t.exports=function(t,n){if(this.on){if(!(t instanceof Function)){if(!t||!n)return;var e=t["#"]||t,o=(this.tag||empty)[e];if(!o)return;return o=this.on(e,n),clearTimeout(o.err),!0}e=n&&n["#"]||Math.random().toString(36).slice(2);if(!t)return e;var i=this.on(e,t,n);return i.err=i.err||setTimeout((function(){i.next({err:"Error: No ACK received yet.",lack:!0}),i.off()}),(this.opt||{}).lack||9e3),e}}}))(o,"./ask"),o((function(t){var n=o("./type");var e=n.time.is;t.exports=function(t){var o={s:{}};return t=t||{max:1e3,age:9e3},o.check=function(t){var n;return!!(n=o.s[t])&&(n.pass?n.pass=!1:o.track(t))},o.track=function(i,r){var a=o.s[i]||(o.s[i]={});return a.was=e(),r&&(a.pass=!0),o.to||(o.to=setTimeout((function(){var i=e();n.obj.map(o.s,(function(e,r){e&&t.age>i-e.was||n.obj.del(o.s,r)})),o.to=null}),t.age+9)),a},o}}))(o,"./dup"),o((function(t){function n(t){return t instanceof n?(this._={gun:this,$:this}).$:this instanceof n?n.create(this._={gun:this,$:this,opt:t}):new n(t)}n.is=function(t){return t instanceof n||t&&t._&&t===t._.$||!1},n.version=.9,n.chain=n.prototype,n.chain.toJSON=function(){};var r=o("./type");r.obj.to(r,n),n.HAM=o("./HAM"),n.val=o("./val"),n.node=o("./node"),n.state=o("./state"),n.graph=o("./graph"),n.on=o("./onto"),n.ask=o("./ask"),n.dup=o("./dup"),function(){function t(e){var o,i,r=this.as,s=r.at||r,u=s.$;(i=e["#"])||(i=e["#"]=f(9)),(o=s.dup).check(i)?r.out===e.out&&(e.out=a,this.to.next(e)):(o.track(i),s.ask(e["@"],e)||(e.get&&n.on.get(e,u),e.put&&n.on.put(e,u)),this.to.next(e),r.out||(e.out=t,s.on("out",e)))}n.create=function(e){e.root=e.root||e,e.graph=e.graph||{},e.on=e.on||n.on,e.ask=e.ask||n.ask,e.dup=e.dup||n.dup();var o=e.$.opt(e.opt);return e.once||(e.on("in",t,e),e.on("out",t,{at:e,out:t}),n.on("create",e),e.on("create",e)),e.once=1,o}}(),function(){function t(t,e,o,i){var r=this,a=n.state.is(o,e);if(!a)return r.err="Error: No state on '"+e+"' in node '"+i+"'!";var s=r.graph[i]||y,u=n.state.is(s,e,!0),c=s[e],f=n.HAM(r.machine,a,u,t,c);f.incoming?(r.put[i]=n.state.to(o,e,r.put[i]),(r.diff||(r.diff={}))[i]=n.state.to(o,e,r.diff[i]),r.souls[i]=!0):f.defer&&(r.defer=a<(r.defer||1/0)?a:r.defer)}function e(t,n){var e=this,a=e.$._,s=(a.next||y)[n];if(!s){if(!(a.opt||y).super)return void(e.souls[n]=!1);s=e.$.get(n)._}var u=e.map[n]={put:t,get:n,$:s.$},c={ctx:e,msg:u};e.async=!!a.tag.node,e.ack&&(u["@"]=e.ack),g(t,o,c),e.async&&(e.and||a.on("node",(function(t){this.to.next(t),t===e.map[t.get]&&(e.souls[t.get]=!1,g(t.put,i,t),g(e.souls,(function(t){if(t)return t}))||e.c||(e.c=1,this.off(),g(e.map,r,e)))})),e.and=!0,a.on("node",u))}function o(t,e){var o=this.ctx,i=o.graph,r=this.msg,a=r.get,s=r.put,u=r.$._;i[a]=n.state.to(s,e,i[a]),o.async||(u.put=n.state.to(s,e,u.put))}function i(t,e){var o=this.put,i=this.$._;i.put=n.state.to(o,e,i.put)}function r(t,n){t.$&&(this.cat.stop=this.stop,t.$._.on("in",t),this.cat.stop=null)}n.on.put=function(o,i){var s=i._,u={$:i,graph:s.graph,put:{},map:{},souls:{},machine:n.state(),ack:o["@"],cat:s,stop:{}};if(n.graph.is(o.put,null,t,u)||(u.err="Error: Invalid graph!"),u.err)return s.on("in",{"@":o["#"],err:n.log(u.err)});g(u.put,e,u),u.async||g(u.map,r,u),a!==u.defer&&setTimeout((function(){n.on.put(o,i)}),u.defer-u.machine),u.diff&&s.on("put",d(o,{put:u.diff}))},n.on.get=function(t,e){var o=e._,i=t.get,r=i[v],a=o.graph[r],s=i[b],u=(o.next||(o.next={}))[r];if(!a)return o.on("get",t);if(s){if("string"!=typeof s||!h(a,s))return o.on("get",t);a=n.state.to(a,s)}else a=n.obj.copy(a);a=n.graph.node(a),(u||y).ack,o.on("in",{"@":t["#"],how:"mem",put:a,$:e}),o.on("get",t)}}(),n.chain.opt=function(t){t=t||{};var e=this._,o=t.peers||t;return p(t)||(t={}),p(e.opt)||(e.opt=t),c(o)&&(o=[o]),s(o)&&(o=g(o,(function(t,n,e){(n={}).id=n.url=t,e(t,n)})),p(e.opt.peers)||(e.opt.peers={}),e.opt.peers=d(o,e.opt.peers)),e.opt.peers=e.opt.peers||{},g(t,(function t(n,e){!h(this,e)||u.is(n)||l.empty(n)?this[e]=n:n&&n.constructor!==Object&&!s(n)||g(n,t,this[e])}),e.opt),n.on("opt",e),e.opt.uuid=e.opt.uuid||function(){return m()+f(12)},this};var a,s=n.list.is,u=n.text,c=u.is,f=u.random,l=n.obj,p=l.is,h=l.has,d=l.to,g=l.map,m=(l.copy,n.state.lex),v=n.val.link._,b=".",y=(n.node._,n.val.link.is,{});e.only=function(t,n){return e.only.i&&t===e.only.i&&e.only.i++&&(e.log.apply(e,arguments)||n)},n.log=function(){return!n.log.off&&e.log.apply(e,arguments),[].slice.call(arguments).join(" ")},n.log.once=function(t,e,o){return(o=n.log.once)[t]=o[t]||0,o[t]++||n.log(e)},n.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, feel free to ask for help on https://gitter.im/amark/gun and ask StackOverflow questions tagged with 'gun'!"),"undefined"!=typeof window&&((window.GUN=window.Gun=n).window=window);try{void 0!==i&&(i.exports=n)}catch(t){}t.exports=n}))(o,"./root"),o((function(t){var n=o("./root");n.chain.back=function(t,o){if(-1===(t=t||1)||1/0===t)return this._.root.$;if(1===t)return(this._.back||this._).$;var r=this._;if("string"==typeof t&&(t=t.split(".")),t instanceof Array){for(var a=0,s=t.length,u=r;a<s;a++)u=(u||i)[t[a]];return e!==u?o?this:u:(u=r.back)?u.$.back(t,o):void 0}if(t instanceof Function){var c;for(u={back:r};(u=u.back)&&e===(c=t(u,o)););return c}return n.num.is(t)?(r.back||r).$.back(t-1):this};var e,i={}}))(o,"./back"),o((function(t){var n=o("./root");function e(t){var e,o,i=this.as,r=i.back,a=i.root;if(t.$||(t.$=i.$),this.to.next(t),e=t.get){if(i.lex&&(t.get=m(i.lex,t.get)),e["#"]||i.soul){if(e["#"]=e["#"]||i.soul,t["#"]||(t["#"]=b(9)),r=a.$.get(e["#"])._,e=e["."]){if(d(r.put,e)){if((o=(s=r.$.get(e)._).ack)||(s.ack=-1),r.on("in",{$:r.$,put:n.state.to(r.put,e),get:r.get}),o)return}else if("string"!=typeof e){var s={},u=(r.put||{})._;n.obj.map(r.put,(function(t,o){n.text.match(o,e)&&(s[o]=t)})),n.obj.empty(s)||(s._=u,r.on("in",{$:r.$,put:s,get:r.get}))}}else{if((o=r.ack)||(r.ack=-1),d(r,"put")&&r.on("in",r),o&&l!==r.put)return;t.$=r.$}return a.ask(f,t),a.on("in",t)}if(a.now&&(a.now[i.id]=a.now[i.id]||!0,i.pass={}),e["."])return i.get?(t={get:{".":i.get},$:i.$},r.ask||(r.ask={}),r.ask[i.get]=t.$._,r.on("out",t)):(t={get:{},$:i.$},r.on("out",t));if(i.ack=i.ack||-1,i.get)return t.$=i.$,e["."]=i.get,(r.ask||(r.ask={}))[i.get]=t.$._,r.on("out",t)}return r.on("out",t)}function i(t){var e,o,i=this.as,s=i.root,f=(t.$||p)._||p,h=t.put;if(i.get&&t.get!==i.get&&(t=m(t,{get:i.get})),i.has&&f!==i&&(t=m(t,{$:i.$}),f.ack&&(i.ack=f.ack)),l===h){if(o=f.put,this.to.next(t),i.soul)return;if(l===o&&l!==f.put)return;return a(i,t),i.has&&c(i,t),g(f.echo,i.id),void g(i.map,f.id)}if(i.soul)return this.to.next(t),a(i,t),void(i.next&&v(h,u,{msg:t,cat:i}));if(!(e=n.val.link.is(h)))return n.val.is(h)?(i.has||i.soul?c(i,t):(f.has||f.soul)&&((f.echo||(f.echo={}))[i.id]=f.echo[f.id]||i,(i.map||(i.map={}))[f.id]=i.map[f.id]||{at:f}),this.to.next(t),void a(i,t)):(i.has&&f!==i&&d(f,"put")&&(i.put=f.put),(e=n.node.soul(h))&&f.has&&(f.put=i.root.$.get(e)._.put),o=(s.stop||{})[f.id],this.to.next(t),r(i,t,f,e),a(i,t),void(i.next&&v(h,u,{msg:t,cat:i})));s.stop;(o=(o=s.stop||{})[f.id]||(o[f.id]={})).is=o.is||f.put,o[i.id]=f.put||!0,this.to.next(t),r(i,t,f,e),a(i,t)}function r(t,e,o,i){if(i&&y!==t.get){var a=t.root.$.get(i)._;t.has?o=a:o.has&&r(o,e,o,i),o!==t&&(o.$||(o={}),(o.echo||(o.echo={}))[t.id]=o.echo[t.id]||t,t.has&&!(t.map||p)[o.id]&&c(t,e),(i!==(a=o.id?(t.map||(t.map={}))[o.id]=t.map[o.id]||{at:o}:{}).link||a.pass||t.pass)&&(t.pass&&(n.obj.map(t.map,(function(t){t.pass=!0})),g(t,"pass")),a.pass&&g(a,"pass"),t.has&&(t.link=i),function(t,e){var o=t.root.$.get(e)._,i=t.lex;if((t.ack||i)&&((i=i||{})["#"]=e,o.on("out",{get:i}),!t.ask))return;o=t.ask,n.obj.del(t,"ask"),v(o||t.next,(function(t,n){var o=t.lex||{};o["#"]=e,o["."]=o["."]||n,t.on("out",{get:o})})),n.obj.del(t,"ask")}(t,a.link=i)))}}function a(t,n,e){t.echo&&v(t.echo,s,n)}function s(t){t&&t.on&&t.on("in",this)}function u(t,e){var o,i,r,a=this.cat.next||p,s=this.msg;(y!==e||a[e])&&(i=a[e])&&(i.has?(l!==i.put&&n.val.link.is(t)||(i.put=t),o=i.$):(r=s.$)&&(r=(o=s.$.get(e))._,l!==r.put&&n.val.link.is(t)||(r.put=t)),i.on("in",{put:t,get:e,$:o,via:s}))}function c(t,e){if(t.has||t.soul){var o=t.map;t.root;t.map=null,t.has&&(t.dub&&t.root.stop&&(t.dub=null),t.link=null),(t.pass||e["@"]||null!==o)&&(l===o&&n.val.link.is(t.put)||(v(o,(function(n){(n=n.at)&&g(n.echo,t.id)})),o=t.put,v(t.next,(function(n,e){if(l===o&&l!==t.put)return!0;n.put=l,n.ack&&(n.ack=-1),n.on("in",{get:e,$:n.$,put:l})}))))}}function f(t,e){var o=this.as,i=o.get||p,r=o.$._,a=(t.put||p)[i["#"]];if(r.ack&&(r.ack=r.ack+1||1),t.put&&("string"!=typeof i["."]||d(a,r.get)))y!=i["."]?n.on.put(t,r.root.$):r.on("in",{get:r.get,put:n.val.link.ify(i["#"]),$:r.$,"@":t["@"]});else{if(r.put!==l)return;r.on("in",{get:r.get,put:r.put=l,$:r.$,"@":t["@"]})}}n.chain.chain=function(t){var o,r=this._,a=new(t||this).constructor(this),s=a._;return s.root=o=r.root,s.id=++o.once,s.back=this._,s.on=n.on,s.on("in",i,s),s.on("out",e,s),a};var l,p={},h=n.obj,d=h.has,g=(h.put,h.del),m=h.to,v=h.map,b=n.text.random,y=(n.val.link._,n.node._)}))(o,"./chain"),o((function(t){var n=o("./root");function e(t){var e,o=this,i=o.as,a=i.at.root,u=(t.$||{})._||{},f=t.put||u.put;if((e=a.now)&&o!==e[i.now])return o.to.next(t);if(o.seen&&u.id&&o.seen[u.id])return o.to.next(t);if((e=f)&&e[c._]&&(e=c.is(e))&&(e=(t.$$=u.root.gun.get(e))._,r!==e.put&&(t=s(t,{put:f=e.put}))),(e=a.mum)&&u.id){var l=u.id+(o.id||(o.id=n.text.random(9)));if(e[l])return;r===f||c.is(f)||(e[l]=!0)}i.use(t,o),o.stun?o.stun=null:o.to.next(t)}function i(t){var n=this.on;if(!t||n.soul||n.has)return this.off();if(t=(t=(t=t.$||t)._||t).id){var e;n.map;if((e=this.seen||(this.seen={}))[t])return!0;e[t]=!0}}n.chain.get=function(t,o,s){var p;if("string"!=typeof t){if(t instanceof Function){if(!0===o)return function(t,n,e,o){var i,a=t._,s=0;if(i=a.soul||a.link||a.dub)return n(i,o,a);if(a.jam)return a.jam.push([n,o]);a.jam=[[n,o]],t.get((function(t,n){if(!(r===t.put&&(i=Object.keys(a.root.opt.peers).length)&&++s<i)){n.rid(t);var e,o=(o=t.$)&&o._||{},u=0;for(i=a.jam,delete a.jam;e=i[u++];){var l=e[0];e=e[1],l&&l(o.link||o.soul||c.is(t.put)||f(t.put)||o.dub,e,t,n)}}}),{out:{get:{".":!0}}})}(this,t,0,s),this;var h,d=(p=this)._,g=d.root,m=g.now;(s=o||{}).at=d,s.use=t,s.out=s.out||{},s.out.get=s.out.get||{},(h=d.on("in",e,s)).rid=i,(g.now={$:1})[s.now=d.id]=h;var v=g.mum;return g.mum={},d.on("out",s.out),g.mum=v,g.now=m,p}return u(t)?this.get(""+t,o,s):(m=c.is(t))?this.get(m,o,s):a.is(t)?(p=this,(m=((m=t["#"])||l)["="]||m)&&(p=p.get(m)),p._.lex=t,p):((s=this.chain())._.err={err:n.log("Invalid get request!",t)},o&&o.call(s,s._.err),s)}return(p=(this._.next||l)[t])||(p=function(t,n){var e=n._,o=e.next,i=n.chain()._;o||(o=e.next={});o[i.get=t]=i,n===e.root.$?i.soul=t:(e.soul||e.has)&&(i.has=t);return i}(t,this)),p=p.$,(m=this._.stun)&&(p._.stun=p._.stun||m),o&&o instanceof Function&&p.get(o,s),p};var r,a=n.obj,s=(a.map,a.has,n.obj.to),u=n.num.is,c=n.val.link,f=n.node.soul,l=(n.node._,{})}))(o,"./get"),o((function(t){var n=o("./root");function e(t){t&&t()}function i(){var t=this;t.graph&&!h(t.stun,r)&&(t.res=t.res||function(t){t&&t()},t.res((function(){var e=t.$.back(-1)._,o=e.ask((function(o){e.root.on("ack",o),o.err&&n.log(o),++i>(t.acks||0)&&this.off(),t.ack&&t.ack(o,this)}),t.opt),i=0,r=e.root.now;f.del(e.root,"now");var a=e.root.mum;e.root.mum={},t.ref._.on("out",{$:t.ref,put:t.out=t.env.graph,opt:t.opt,"#":o}),e.root.mum=a?f.to(a,e.root.mum):a,e.root.now=r}),t),t.res&&t.res())}function r(t,n){if(t)return!0}function a(t,e,o,i){var r=this,a=n.is(t);!e&&i.path.length&&(r.res||m)((function(){for(var e=i.path,o=r.ref,u=(r.opt,0),c=e.length;u<c;u++)o=o.get(e[u]);a&&(o=t);var f=o._.dub;if(f||(f=n.node.soul(i.obj)))return o.back(-1).get(f),void i.soul(f);(r.stun=r.stun||{})[e]=!0,o.get(s,!0,{as:{at:i,as:r,p:e}})}),{as:r,at:i})}function s(t,e,o,i){var r=(e=e.as).at;e=e.as;var a=((o||{}).$||{})._||{};t=a.dub=a.dub||t||n.node.soul(r.obj)||n.node.soul(o.put||a.put)||n.val.link.is(o.put||a.put)||(e.via.back("opt.uuid")||n.text.random)(),i&&(i.stun=!0),t?u(a,a.dub=t,r,e):e.via.back("opt.uuid")((function(t,o){if(t)return n.log(t);u(a,a.dub=a.dub||o,r,e)}))}function u(t,n,e,o){t.$.back(-1).get(n),e.soul(n),o.stun[e.path]=!1,o.batch()}function c(t,e,o,i){if(e=e.as,o.$&&o.$._)if(o.err)n.log("Please report this as an issue! Put.any.err");else{var r,a=o.$._,s=a.put,u=e.opt||{};if(!(r=e.ref)||!r._.now){if(i&&(i.stun=!0),e.ref!==e.$){if(!(r=e.$._.get||a.get))return void n.log("Please report this as an issue! Put.no.get");e.data=p({},r,e.data),r=null}if(void 0===s){if(!a.get)return;t||(r=a.$.back((function(t){if(t.link||t.soul)return t.link||t.soul;e.data=p({},t.get,e.data)})),e.not=!0),a=(r=r||a.soul||a.link||a.dub)?a.root.$.get(r)._:a,e.soul=r,s=e.data}e.not||(e.soul=e.soul||t)||(e.path&&l(e.data)?e.soul=(u.uuid||e.via.back("opt.uuid")||n.text.random)():(v==a.get&&(e.soul=(a.put||d)["#"]||a.dub),e.soul=e.soul||a.soul||a.link||(u.uuid||e.via.back("opt.uuid")||n.text.random)()),e.soul)?e.ref.put(e.data,e.soul,e):e.via.back("opt.uuid")((function(t,o){if(t)return n.log(t);e.ref.put(e.data,e.soul=o,e)}))}}}n.chain.put=function(t,o,r){var s,u=this,f=u._,h=f.root.$;h._;return(r=r||{}).data=t,r.via=r.$=r.via||r.$||u,"string"==typeof o?r.soul=o:r.ack=r.ack||o,f.soul&&(r.soul=f.soul),r.soul||h===u?l(r.data)?(r.soul=r.soul||(r.not=n.node.soul(r.data)||(r.via.back("opt.uuid")||n.text.random)()),r.soul?(r.$=h.get(r.soul),r.ref=r.$,function(t){t.batch=i;var e=t.opt||{},o=t.env=n.state.map(a,e.state);if(o.soul=t.soul,t.graph=n.graph.ify(t.data,o,t),o.err)return(t.ack||g).call(t,t.out={err:n.log(o.err)}),void(t.res&&t.res());t.batch()}(r),u):(r.via.back("opt.uuid")((function(t,e){if(t)return n.log(t);(r.ref||r.$).put(r.data,r.soul=e,r)})),u)):((r.ack||g).call(r,r.out={err:n.log("Data saved to the root level of the graph must be a node (an object), not a",typeof r.data,'of "'+r.data+'"!')}),r.res&&r.res(),u):n.is(t)?(t.get((function(t,e,i){if(!t)return n.log("The reference you are saving is a",typeof i.put,'"'+i.put+'", not a node (object)!');u.put(n.val.link.ify(t),o,r)}),!0),u):(f.has&&(s=n.val.link.is(t))&&(f.dub=s),r.ref=r.ref||h._===(s=f.back)?u:s.$,r.ref._.soul&&n.val.is(r.data)&&f.get?(r.data=p({},f.get,r.data),r.ref.put(r.data,r.soul,r),u):(r.ref.get(c,!0,{as:r}),r.out||(r.res=r.res||e,r.$._.stun=r.ref._.stun),u))};var f=n.obj,l=f.is,p=f.put,h=f.map,d={},g=function(){},m=function(t,n){t.call(n||d)},v=n.node._}))(o,"./put"),o((function(t){var n=o("./root");o("./chain"),o("./back"),o("./put"),o("./get"),t.exports=n}))(o,"./index"),o((function(t){var n=o("./index");function e(t,n){var e,o=t.$,i=((o||{})._||{}).put||t.put;this.at;if(r!==i){if(e=t.$$){if(e=t.$$._,r===e.put)return;i=e.put}this.change&&(i=t.put),this.as?this.ok.call(this.as,t,n):this.ok.call(o,i,t.get,t,n)}}function i(t,e,o){if(t.$){var a,s,u=this.as,f=(u.at,t.$),l=f._,p=l.put||t.put;(s=t.$$)&&(a=s=t.$$._,r!==a.put&&(p=a.put)),(s=e.wait)&&(s=s[l.id])&&clearTimeout(s),e.ack=(e.ack||0)+1,!o&&r===p&&e.ack<=(u.acks||Object.keys(l.root.opt.peers).length)||(!o&&(r===p||l.soul||l.link||a&&!(0<a.ack))||r===p&&(s=Object.keys(l.root.opt.peers).length)&&!o&&(a||l).ack<s?s=(e.wait={})[l.id]=setTimeout((function(){i.call({as:u},t,e,s||1)}),u.wait||99):(a&&r===a.put&&(s=c.is(p))&&(p=n.node.ify({},s)),e.rid?e.rid(t):e.off(),u.ok.call(f||u.$,p,t.get)))}else e.off()}n.chain.on=function(t,n,o,i){var r,a=this._;if("string"==typeof t)return n?(r=a.on(t,n,o||a,i),o&&o.$&&(o.subs||(o.subs=[])).push(r),this):a.on(t);var s=n;return(s=!0===s?{change:!0}:s||{}).at=a,s.ok=t,this.get(e,s),this},n.chain.val=function(t,e){return n.log.once("onceval","Future Breaking API Change: .val -> .once, apologies unexpected."),this.once(t,e)},n.chain.once=function(t,e){var o=this,a=o._,s=a.put;if(0<a.ack&&r!==s)return(t||f).call(o,s,a.get),o;if(!t){n.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it.");var u=o.chain();return u._.nix=o.once((function(){u._.on("in",o._)})),u}return(e=e||{}).ok=t,e.at=a,e.out={"#":n.text.random(9)},o.get(i,{as:e}),e.async=!0,o},n.chain.off=function(){var t,n=this._,e=n.back;if(e)return n.ack=0,(t=e.next)&&t[n.get]&&u(t,n.get),(t=e.ask)&&u(t,n.get),(t=e.put)&&u(t,n.get),(t=n.soul)&&u(e.root.graph,t),(t=n.map)&&s(t,(function(t){t.link&&e.root.$.get(t.link).off()})),(t=n.next)&&s(t,(function(t){t.$.off()})),n.on("off",{}),this};var r,a=n.obj,s=a.map,u=(a.has,a.del),c=(a.to,n.val.link),f=function(){}}))(o,"./on"),o((function(t){var n=o("./index");function e(t){if(!t.put||n.val.is(t.put))return this.to.next(t);this.as.nix&&this.off(),r(t.put,i,{at:this.as,msg:t}),this.to.next(t)}function i(t,e){if(s!==e){var o=this.msg.$,i=o._,r=this.at,a=i.lex;a&&!n.text.match(e,a["."]||a["#"]||a)||(((a=o.get(e)._).echo||(a.echo={}))[r.id]=a.echo[r.id]||r)}}n.chain.map=function(t,o,i){var r,s=this._;return t?(n.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),r=this.chain(),this.map().on((function(e,o,i,s){var u=(t||a).call(this,e,o,i,s);if(void 0!==u)return e===u?r._.on("in",i):n.is(u)?r._.on("in",u._):void r._.on("in",{get:o,put:u})})),r):((r=s.each)||(s.each=r=this.chain(),r._.nix=this.back("nix"),this.on("in",e,r._)),r)};var r=n.obj.map,a=function(){},s=n.node._}))(o,"./map"),o((function(t){var n=o("./index");n.chain.set=function(t,e,o){var i,r=this;return e=e||function(){},(o=o||{}).item=o.item||t,(i=n.node.soul(t))&&(t=n.obj.put({},i,n.val.link.ify(i))),n.is(t)?(t.get((function(t,i,a){if(!t)return e.call(r,{err:n.log('Only a node can be linked! Not "'+a.put+'"!')});r.put(n.obj.put({},t,n.val.link.ify(t)),e,o)}),!0),t):(n.obj.is(t)&&(t=r.back(-1).get(i=i||n.node.soul(t)||r.back("opt.uuid")()).put(t)),r.get(i||n.state.lex()+n.text.random(7)).put(t,e,o))}}))(o,"./set"),o((function(t){if("undefined"!=typeof Gun){var n;try{n=(Gun.window||function(){}).localStorage}catch(t){}n||(Gun.log("Warning: No localStorage exists to persist data to!"),n={setItem:function(t,n){this[t]=n},removeItem:function(t){delete this[t]},getItem:function(t){return this[t]}}),Gun.on("create",(function(t){var e=this.to,o=t.opt;if(t.once)return e.next(t);if(!1===o.localStorage)return e.next(t);o.prefix=o.file||"gun/";var i,r,a=Gun.obj.ify(n.getItem("gap/"+o.prefix))||{},s=Gun.obj.empty;if(!s(a)){var u=Gun.obj.ify(n.getItem(o.prefix))||{},c={};Gun.obj.map(a,(function(t,n){Gun.obj.map(t,(function(t,e){c[n]=Gun.state.to(u[n],e,c[n])}))})),setTimeout((function(){t.on("out",{put:c,"#":t.ask(f)})}),1)}function f(t){if(!t.err&&t.ok){var n=t["@"];setTimeout((function(){Gun.obj.map(a,(function(t,e){Gun.obj.map(t,(function(e,o){n===e&&delete t[o]})),s(t)&&delete a[e]})),p()}),o.wait||1)}}t.on("out",(function(t){t.lS||(Gun.is(t.$)&&t.put&&!t["@"]&&(i=t["#"],Gun.graph.is(t.put,null,l),r||(r=setTimeout(p,o.wait||1))),this.to.next(t))})),t.on("ack",f),e.next(t);var l=function(t,n,e,o){(a[o]||(a[o]={}))[n]=i},p=function(){clearTimeout(r),r=!1;try{n.setItem("gap/"+o.prefix,JSON.stringify(a))}catch(t){Gun.log(err=t||"localStorage failure")}}})),Gun.on("create",(function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.localStorage){e.prefix=e.file||"gun/";t.graph;var o,i={},r=0,a=Gun.obj.ify(n.getItem(e.prefix))||{};t.on("localStorage",a),t.on("put",(function(t){if(this.to.next(t),Gun.graph.is(t.put,null,s),t["@"]||(i[t["#"]]=!0),(r+=1)>=(e.batch||1e3))return u();o||(o=setTimeout(u,e.wait||1))})),t.on("get",(function(n){this.to.next(n);var e,o,i=n.get;function r(){if(i&&(e=i["#"])){var r=i["."];(o=a[e]||void 0)&&r&&(o=Gun.state.to(o,r)),t.on("in",{"@":n["#"],put:Gun.graph.node(o),how:"lS",lS:n.$})}}Gun.debug?setTimeout(r,1):r()}));var s=function(t,n,e,o){a[o]=Gun.state.to(e,n,a[o])},u=function(s){var c;r=0,clearTimeout(o),o=!1;var f=i;i={},s&&(a=s);try{n.setItem(e.prefix,JSON.stringify(a))}catch(n){Gun.log(c=(n||"localStorage failure")+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),t.on("localStorage:error",{err:c,file:e.prefix,flush:a,retry:u})}(c||Gun.obj.empty(e.peers))&&Gun.obj.map(f,(function(n,e){t.on("in",{"@":e,err:c,ok:0})}))}}}))}}))(o,"./adapters/localStorage"),o((function(t){var n=o("../type"),i="undefined"!=typeof setImmediate?setImmediate:setTimeout;!function(){n.text.hash=function(t){if("string"!=typeof t)return{err:1};var n=0;if(!t.length)return n;for(var e=0,o=t.length;e<o;++e)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n};var t=JSON.stringify;function e(t,e){var i;return e instanceof Object?(n.obj.map(Object.keys(e).sort(),o,{to:i={},on:e}),i):e}function o(t){this.to[t]=this.on[t]}n.obj.hash=function(o,i){if(i||void 0!==(o=t(o,e)))return n.text.hash(i||o||"")},n.obj.hash.sort=e}();var r,a=!0,s=e.LOG;try{t.exports=function(t){var o=function(){},u=t.opt||{};u.log=u.log||e.log,u.gap=u.gap||u.wait||1,u.pack=u.pack||.3*(u.memory?1e3*u.memory*1e3:1399e6);var c=t.dup;o.hear=function(e,a){if(e){var l,p,h,d=e[0];if(u.pack<=e.length)return o.say({dam:"!",err:"Message too big!"},a);if("{"!=e[2]&&(o.hear.d+=e.length||0,++o.hear.c),"["===d){try{l=JSON.parse(e)}catch(t){u.log("DAM JSON parse error",t)}if(!l)return;return s&&u.log(+new Date,l.length,"in hear batch"),void function t(){var n;s&&(n=+new Date);for(var e,r=100;r--&&(e=l.shift());)o.hear(e,a);s&&u.log(n,+new Date-n,"batch heard"),l.length&&i(t,0)}()}if("{"===d||n.obj.is(e)&&(l=e)){try{l=l||JSON.parse(e)}catch(t){return u.log("DAM JSON parse error",t)}if(!l)return;if((p=l["#"])||(p=l["#"]=n.text.random(9)),l.DBG_s&&u.log(+new Date-l.DBG_s,"to hear",p),c.check(p))return;if(c.track(p,!0).it=l,(h=l["##"])||r===l.put||(h=l["##"]=n.obj.hash(l.put)),h&&(d=l["@"]||l.get&&p)){if(c.check(d+h))return;c.track(d+h,!0).it=l}return(l._=function(){}).via=a,(d=l["><"])&&(l._.to=n.obj.map(d.split(","),f)),l.dam?void((d=o.hear[l.dam])&&d(l,a,t)):(s&&(g=+new Date),t.on("in",l),void(s&&!l.nts&&u.log(g,+new Date-g,"msg",l["#"])));var g}}};var f=function(t,n,e){e(t,!0)};function l(t,n){try{var e,i=n.wire;s&&(e=+new Date),n.say?n.say(t):i.send&&i.send(t),s&&u.log(e,+new Date-e,"wire send",t.length),o.say.d+=t.length||0,++o.say.c}catch(e){(n.queue=n.queue||[]).push(t)}}o.hear.c=o.hear.d=0,function(){var t;function e(n){o.say(t,n)}function i(t){var n=t.batch;if(t.batch=t.tail=null,n&&n.length){var e;s&&(e=+new Date);try{n=1===n.length?n[0]:JSON.stringify(n)}catch(t){return u.log("DAM JSON stringify error",t)}s&&u.log(e,+new Date-e,"say stringify",n.length),n&&l(n,t)}}(o.say=function(f,p){if(this.to&&this.to.next(f),!f)return!1;var h,d,g,m;s&&(v=+new Date);var v,b=f._||(f._=function(){});if((h=f["#"])||(h=f["#"]=n.text.random(9)),(d=f["##"])||r===f.put||(d=f["##"]=n.obj.hash(f.put)),!(m=b.raw)&&(m=b.raw=o.raw(f),d&&(g=f["@"])&&(c.track(g+d).it=f,g=(c.s[g]||a).it))){if(d===g["##"])return!1;g["##"]=d}if(s&&u.log(v,+new Date-v,"say prep"),c.track(h).it=f,p||(p=(g=c.s[f["@"]])&&(g=g.it)&&(g=g._)&&(g=g.via)),!p&&o.way)return o.way(f);if(!p||!p.id)return t=f,!!n.obj.is(p||u.peers)&&(s&&(v=+new Date),n.obj.map(p||u.peers,e),void(s&&u.log(v,+new Date-v,"say loop")));if(!p.wire&&o.wire&&o.wire(p),h!==p.last){if(p.last=h,p===b.via)return!1;if((g=b.to)&&(g[p.url]||g[p.pid]||g[p.id]))return!1;if(p.batch){if(p.tail=(g=p.tail||0)+m.length,p.tail<=u.pack)return void p.batch.push(m);i(p)}p.batch=[],setTimeout((function(){i(p)}),u.gap),l(m,p)}}).c=o.say.d=0}(),function(){o.raw=function(e){if(!e)return"";var o,i=e._||{};if(o=i.raw)return o;if("string"==typeof e)return e;if(!e.dam){var r=0,a=[];n.obj.map(u.peers,(function(t){if(a.push(t.url||t.pid||t.id),++r>9)return!0})),r>1&&(e["><"]=a.join())}var s=t(e);return i&&(i.raw=s),s};var t=JSON.stringify}(),o.hi=function(e){var i=e.wire||{};e.id?u.peers[e.url||e.id]=e:(i=e.id=e.id||n.text.random(9),o.say({dam:"?",pid:t.opt.pid},u.peers[i]=e),delete c.s[e.last]),e.met=e.met||+new Date,i.hied||t.on(i.hied="hi",e),i=e.queue,e.queue=[],n.obj.map(i,(function(t){l(t,e)}))},o.bye=function(n){t.on("bye",n);var i=+new Date;i-=n.met||i,o.bye.time=((o.bye.time||i)+i)/2,s=e.LOG},o.hear["!"]=function(t,n){u.log("Error:",t.err)},o.hear["?"]=function(t,n){t.pid&&(n.pid||(n.pid=t.pid),t["@"])||(o.say({dam:"?",pid:u.pid,"@":t["#"]},n),delete c.s[n.last])},t.on("create",(function(t){t.opt.pid=t.opt.pid||n.text.random(9),this.to.next(t),t.on("out",o.say)})),t.on("bye",(function(t,e){t=u.peers[t.id||t]||t,this.to.next(t),t.bye?t.bye():(e=t.wire)&&e.close&&e.close(),n.obj.del(u.peers,t.id),t.wire=null}));var p={};return t.on("bye",(function(t,n){this.to.next(t),(n=t.url)&&(p[n]=!0,setTimeout((function(){delete p[n]}),u.lack||9e3))})),t.on("hi",(function(e,i){this.to.next(e),(i=e.url)&&p[i]&&(delete p[i],n.obj.map(t.next,(function(r,a){(i={})[a]=t.graph[a],o.say({"##":n.obj.hash(i),get:{"#":a}},e)})))})),o}}catch(t){}}))(o,"./adapters/mesh"),o((function(t){var n=o("../index");n.Mesh=o("./mesh"),n.on("opt",(function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.WebSocket){var o;"undefined"!=typeof window&&(o=window),void 0!==ut&&(o=ut),o=o||{};var i=e.WebSocket||o.WebSocket||o.webkitWebSocket||o.mozWebSocket;if(i){e.WebSocket=i;var r=e.mesh=e.mesh||n.Mesh(t);r.wire||e.wire;r.wire=e.wire=s,setTimeout((function(){t.on("out",{dam:"hi"})}),1);var a="undefined"!=typeof document&&document}}function s(t){try{if(!t||!t.url)return o&&o(t);var n=t.url.replace("http","ws"),o=t.wire=new e.WebSocket(n);return o.onclose=function(){e.mesh.bye(t),u(t)},o.onerror=function(n){u(t)},o.onopen=function(){e.mesh.hi(t)},o.onmessage=function(n){n&&e.mesh.hear(n.data||n,t)},o}catch(t){}}function u(t){clearTimeout(t.defer),a&&t.retry<=0||(t.retry=(t.retry||e.retry||60)-1,t.defer=setTimeout((function n(){if(a&&a.hidden)return setTimeout(n,2e3);s(t)}),2e3))}}))}))(o,"./adapters/websocket")}()}));const ft=function(){const t=new ct(["http://phrassed.com/gun","https://gunjs.herokuapp.com/gun"]),{subscribe:n,update:e}=st([]),o=t.get("chats");return o.map().on((t,n)=>{e(e=>t?(t&&e.push({msgId:n,msg:t.msg,time:parseFloat(t.time),user:t.user}),e):(function(t,n){for(let e in t)if(t[e].msgId==n){t.splice(e,1);break}}(e,n),e))}),{subscribe:n,delete:t=>{o.get(t).put(null)},set:({msg:t,user:n})=>{const e=(new Date).getTime(),i=`${e}_${Math.random()}`;o.get(i).put({msg:t,user:n,time:e})}}}();const lt=function(){const t=JSON.parse(sessionStorage.getItem("chat_user")),{subscribe:n,update:e,set:o}=st(t);return n(t=>{sessionStorage.setItem("chat_user",JSON.stringify(t))}),{subscribe:n,update:e,set:o}}();function pt(t,{delay:e=0,duration:o=400,easing:i=n}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:o,easing:i,css:t=>"opacity: "+t*r}}function ht(t,n,e){const o=t.slice();return o[11]=n[e],o}function dt(t){let n,e,o,r,a,s,u,c,f,l,p,h,d,S,O=[],D=new Map,G=t[3];const N=t=>t[11].msgId;for(let n=0;n<G.length;n+=1){let e=ht(t,G,n),o=N(e);D.set(o,O[n]=mt(o,e))}let T=t[0]&&vt();return{c(){n=b("main"),e=b("h1"),o=y("To: "),r=y(t[2]),a=k(),s=b("div");for(let t=0;t<O.length;t+=1)O[t].c();u=k(),c=b("form"),f=b("input"),l=k(),T&&T.c(),w(s,"class","scrollable svelte-1e5w08s"),w(f,"class","msg-input svelte-1e5w08s"),w(f,"type","text"),w(f,"name","msg"),w(c,"class","submit-form svelte-1e5w08s"),w(c,"method","get"),w(n,"class","svelte-1e5w08s")},m(p,h,v){m(p,n,h),g(n,e),g(e,o),g(e,r),g(n,a),g(n,s);for(let t=0;t<O.length;t+=1)O[t].m(s,null);t[8](s),g(n,u),g(n,c),g(c,f),j(f,t[0]),g(c,l),T&&T.m(c,null),d=!0,v&&i(S),S=[_(f,"input",t[9]),_(c,"submit",$(t[10]))]},p(t,n){if((!d||4&n)&&x(r,t[2]),24&n){const e=t[3];V(),O=function(t,n,e,o,i,r,a,s,u,c,f,l){let p=t.length,h=r.length,d=p;const g={};for(;d--;)g[t[d].key]=d;const m=[],v=new Map,b=new Map;for(d=h;d--;){const t=l(i,r,d),s=e(t);let u=a.get(s);u?o&&u.p(t,n):(u=c(s,t),u.c()),v.set(s,m[d]=u),s in g&&b.set(s,Math.abs(d-g[s]))}const y=new Set,k=new Set;function _(t){Z(t,1),t.m(s,f,a.has(t.key)),a.set(t.key,t),f=t.first,h--}for(;p&&h;){const n=m[h-1],e=t[p-1],o=n.key,i=e.key;n===e?(f=n.first,p--,h--):v.has(i)?!a.has(o)||y.has(o)?_(n):k.has(i)?p--:b.get(o)>b.get(i)?(k.add(o),_(n)):(y.add(i),p--):(u(e,a),p--)}for(;p--;){const n=t[p];v.has(n.key)||u(n,a)}for(;h;)_(m[h-1]);return m}(O,n,N,1,t,e,D,s,ot,mt,null,ht),X()}1&n&&f.value!==t[0]&&j(f,t[0]),t[0]?T?Z(T,1):(T=vt(),T.c(),Z(T,1),T.m(c,null)):T&&(V(),Y(T,1,1,()=>{T=null}),X())},i(t){if(!d){for(let t=0;t<G.length;t+=1)Z(O[t]);Z(T),q(()=>{h&&h.end(1),p||(p=nt(n,pt,{})),p.start()}),d=!0}},o(t){for(let t=0;t<O.length;t+=1)Y(O[t]);Y(T),p&&p.invalidate(),h=et(n,pt,{}),d=!1},d(e){e&&v(n);for(let t=0;t<O.length;t+=1)O[t].d();t[8](null),T&&T.d(),e&&h&&h.end(),i(S)}}}function gt(n){let e,o,i,r,a,s,u,c,f,l,p,h,d;return{c(){e=b("main"),o=b("h1"),o.textContent="Enter your name",i=k(),r=b("form"),a=b("input"),s=k(),u=b("input"),w(o,"id","name-label"),w(a,"placeholder","Steve Jobs"),w(a,"aria-labelledby","name-label"),w(a,"name","user"),w(a,"class","user-input svelte-1e5w08s"),w(u,"class","submit svelte-1e5w08s"),w(u,"type","submit"),u.value="Send",w(r,"class","user-input svelte-1e5w08s"),w(e,"class","svelte-1e5w08s")},m(t,c,f){m(t,e,c),g(e,o),g(e,i),g(e,r),g(r,a),g(r,s),g(r,u),h=!0,f&&d(),d=_(r,"submit",$(n[6]))},p:t,i(t){h||(q(()=>{f&&f.end(1),c||(c=nt(u,pt,{})),c.start()}),q(()=>{p&&p.end(1),l||(l=nt(e,pt,{})),l.start()}),h=!0)},o(t){c&&c.invalidate(),f=et(u,pt,{}),l&&l.invalidate(),p=et(e,pt,{}),h=!1},d(t){t&&v(e),t&&f&&f.end(),t&&p&&p.end(),d()}}}function mt(t,n){let e,o,i,r,a,s,u,c,f,l,p,h,d,j,O,D,G=new Date(n[11].time).toLocaleString("en-US")+"",N=n[11].user+"",T=n[11].msg+"";function A(...t){return n[7](n[11],...t)}return{key:t,first:null,c(){e=b("article"),o=b("div"),i=b("span"),r=y(G),a=k(),s=b("span"),u=y(N),c=k(),f=b("span"),l=y(T),p=k(),h=b("button"),h.textContent="delete",d=k(),w(i,"class","time"),w(s,"class","user svelte-1e5w08s"),w(o,"class","meta svelte-1e5w08s"),w(h,"class","delete svelte-1e5w08s"),w(f,"class","msg svelte-1e5w08s"),w(e,"class","svelte-1e5w08s"),S(e,"user",n[11].user===n[4]),this.first=e},m(t,n,v){m(t,e,n),g(e,o),g(o,i),g(i,r),g(o,a),g(o,s),g(s,u),g(e,c),g(e,f),g(f,l),g(f,p),g(f,h),g(e,d),O=!0,v&&D(),D=_(h,"click",$(A))},p(t,o){n=t,(!O||8&o)&&G!==(G=new Date(n[11].time).toLocaleString("en-US")+"")&&x(r,G),(!O||8&o)&&N!==(N=n[11].user+"")&&x(u,N),(!O||8&o)&&T!==(T=n[11].msg+"")&&x(l,T),24&o&&S(e,"user",n[11].user===n[4])},i(t){O||(j&&j.end(1),O=!0)},o(t){j=et(e,pt,{}),O=!1},d(t){t&&v(e),t&&j&&j.end(),D()}}}function vt(t){let n,e,o,i;return{c(){n=b("input"),w(n,"class","submit svelte-1e5w08s"),w(n,"type","submit"),n.value="Send"},m(t,e){m(t,n,e),i=!0},i(t){i||(q(()=>{o&&o.end(1),e||(e=nt(n,pt,{})),e.start()}),i=!0)},o(t){e&&e.invalidate(),o=et(n,pt,{}),i=!1},d(t){t&&v(n),t&&o&&o.end()}}}function bt(t){let n,e,o,i;const r=[gt,dt],a=[];function s(t,n){return t[4]?1:0}return n=s(t),e=a[n]=r[n](t),{c(){e.c(),o=y("")},m(t,e){a[n].m(t,e),m(t,o,e),i=!0},p(t,[i]){let u=n;n=s(t),n===u?a[n].p(t,i):(V(),Y(a[u],1,1,()=>{a[u]=null}),X(),e=a[n],e||(e=a[n]=r[n](t),e.c()),Z(e,1),e.m(o.parentNode,o))},i(t){i||(Z(e),i=!0)},o(t){Y(e),i=!1},d(t){a[n].d(t),t&&v(o)}}}function yt(t,n,e){let o,i,r,a,c;var f;s(t,ft,t=>e(3,o=t)),s(t,lt,t=>e(4,i=t)),f=()=>{c=a&&a.offsetHeight+a.scrollTop<a.scrollHeight+50},I().$$.before_update.push(f),function(t){I().$$.after_update.push(t)}(()=>{c&&a.scrollTo(0,a.scrollHeight-50)}),function(t){I().$$.on_mount.push(t)}(()=>{a&&a.scrollTo(0,a.scrollHeight-50)});let l;return t.$$.update=()=>{24&t.$$.dirty&&e(2,l=[...new Set(o.map(t=>t.user).filter(t=>t&&t!==i))].join(", "))},[r,a,l,o,i,c,t=>{const n=t.target.user.value;n&&u(lt,i=n)},(t,n)=>{ft.delete(t.msgId)},function(t){E[t?"unshift":"push"](()=>{e(1,a=t)})},function(){r=this.value,e(0,r)},()=>{r&&(u(ft,o={msg:r,user:i}),e(0,r=""))}]}return new class extends class{$destroy(){!function(t,n){const e=t.$$;null!==e.fragment&&(i(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}{constructor(t){super(),rt(this,t,yt,bt,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
